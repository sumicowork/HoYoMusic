# TAG åŠŸèƒ½å®Œå–„ - å®ç°æ€»ç»“

## æ¦‚è¿°

æ ¹æ®PRDè¦æ±‚ï¼Œå®Œå–„äº†TAGï¼ˆæ ‡ç­¾ï¼‰åŠŸèƒ½ï¼Œä½¿ç®¡ç†å‘˜èƒ½å¤Ÿåœ¨åå°å¯¹å•æ›²è¿›è¡ŒTAGä¿®æ”¹æ“ä½œã€‚

## PRDç›¸å…³éœ€æ±‚

æ ¹æ®PRD 2.2.5èŠ‚ï¼š
- **æ ‡ç­¾ç³»ç»Ÿ**: æ”¯æŒè‡ªå®šä¹‰æ ‡ç­¾
- **æŒ‰æ ‡ç­¾æµè§ˆ**: ç”¨æˆ·å¯ä»¥æŒ‰æ ‡ç­¾æµè§ˆéŸ³ä¹

## å®ç°çš„åŠŸèƒ½

### 1. åœ¨Adminé¡µé¢æ·»åŠ å•æ›²TAGç®¡ç† âœ…

**ä¿®æ”¹æ–‡ä»¶**: `frontend/src/pages/Admin.tsx`

**æ–°å¢åŠŸèƒ½**:
- åœ¨æ¯é¦–æ­Œæ›²çš„æ“ä½œæ æ·»åŠ äº† **"Tags"** æŒ‰é’®
- ç‚¹å‡»åå¼¹å‡ºæ ‡ç­¾ç®¡ç†å¯¹è¯æ¡†ï¼Œå¯ä»¥ä¸ºå•æ›²æ·»åŠ /åˆ é™¤æ ‡ç­¾
- é›†æˆäº†å·²æœ‰çš„ `TrackTagsManager` ç»„ä»¶

**å…·ä½“æ”¹åŠ¨**:
1. å¯¼å…¥ `TagsOutlined` å›¾æ ‡å’Œ `TrackTagsManager` ç»„ä»¶
2. æ·»åŠ çŠ¶æ€ç®¡ç†ï¼š
   - `tagsManagerVisible`: æ§åˆ¶æ ‡ç­¾ç®¡ç†å¯¹è¯æ¡†æ˜¾ç¤º
   - `currentTrackTitle`: å­˜å‚¨å½“å‰æ“ä½œçš„æ›²ç›®æ ‡é¢˜
3. åœ¨æ“ä½œåˆ—æ·»åŠ  Tags æŒ‰é’®ï¼ˆä½äº Credits å’Œ Download ä¹‹é—´ï¼‰
4. åœ¨é¡µé¢åº•éƒ¨æ·»åŠ  `TrackTagsManager` æ¨¡æ€æ¡†

**ç”¨æˆ·æ“ä½œæµç¨‹**:
1. ç®¡ç†å‘˜åœ¨ Admin é¡µé¢æ‰¾åˆ°è¦ç¼–è¾‘çš„æ›²ç›®
2. ç‚¹å‡» "Tags" æŒ‰é’®
3. åœ¨å¼¹å‡ºçš„å¯¹è¯æ¡†ä¸­ï¼š
   - æŸ¥çœ‹å½“å‰å·²æ·»åŠ çš„æ ‡ç­¾ï¼ˆå¯ç‚¹å‡» X åˆ é™¤ï¼‰
   - ä»ä¸‹æ‹‰åˆ—è¡¨é€‰æ‹©æ–°æ ‡ç­¾æ·»åŠ 
   - å¦‚æœæ²¡æœ‰å¯ç”¨æ ‡ç­¾ï¼Œä¼šæç¤ºå»"æ ‡ç­¾ç®¡ç†"é¡µé¢åˆ›å»º

### 2. åˆ›å»ºæ ‡ç­¾ç®¡ç†é¡µé¢ âœ…

**æ–°å»ºæ–‡ä»¶**: 
- `frontend/src/pages/TagManagement.tsx`
- `frontend/src/pages/TagManagement.css`

**åŠŸèƒ½ç‰¹æ€§**:
- âœ… **æŸ¥çœ‹æ‰€æœ‰æ ‡ç­¾**: è¡¨æ ¼å½¢å¼å±•ç¤ºæ‰€æœ‰æ ‡ç­¾åŠå…¶ä¿¡æ¯
- âœ… **åˆ›å»ºæ ‡ç­¾**: 
  - æ ‡ç­¾åç§°ï¼ˆå¿…å¡«ï¼‰
  - æ ‡ç­¾é¢œè‰²ï¼ˆé¢œè‰²é€‰æ‹©å™¨ï¼Œé»˜è®¤ #1890ffï¼‰
  - æ ‡ç­¾æè¿°ï¼ˆå¯é€‰ï¼‰
- âœ… **ç¼–è¾‘æ ‡ç­¾**: ä¿®æ”¹å·²æœ‰æ ‡ç­¾çš„åç§°ã€é¢œè‰²ã€æè¿°
- âœ… **åˆ é™¤æ ‡ç­¾**: åˆ é™¤æ ‡ç­¾ï¼ˆä¼šè§£é™¤æ‰€æœ‰æ­Œæ›²çš„å…³è”ï¼‰
- âœ… **æ˜¾ç¤ºç»Ÿè®¡**: æ˜¾ç¤ºæ¯ä¸ªæ ‡ç­¾å…³è”çš„æ­Œæ›²æ•°é‡
- âœ… **æ˜¾ç¤ºæ—¶é—´**: æ˜¾ç¤ºæ ‡ç­¾åˆ›å»ºæ—¶é—´

**è¡¨æ ¼åˆ—**:
| åˆ—å | è¯´æ˜ |
|------|------|
| æ ‡ç­¾ | æ ‡ç­¾åç§° + é¢œè‰²æ–¹å— |
| æè¿° | æ ‡ç­¾æè¿°ä¿¡æ¯ |
| æ­Œæ›²æ•°é‡ | å…³è”çš„æ­Œæ›²æ•° |
| åˆ›å»ºæ—¶é—´ | æ ‡ç­¾åˆ›å»ºæ—¥æœŸ |
| æ“ä½œ | ç¼–è¾‘/åˆ é™¤æŒ‰é’® |

### 3. è·¯ç”±é…ç½® âœ…

**ä¿®æ”¹æ–‡ä»¶**: `frontend/src/App.tsx`

**æ–°å¢è·¯ç”±**: `/admin/tags`
- è®¿é—®è·¯å¾„: `http://localhost:5173/admin/tags`
- éœ€è¦ç®¡ç†å‘˜ç™»å½•è®¤è¯
- å— `ProtectedRoute` ä¿æŠ¤

### 4. å¯¼èˆªå…¥å£ âœ…

**ä¿®æ”¹æ–‡ä»¶**: `frontend/src/pages/Admin.tsx`

**æ·»åŠ å¯¼èˆªæŒ‰é’®**:
- åœ¨Adminé¡µé¢çš„Headerä¸­æ·»åŠ äº† "Tag Management" æŒ‰é’®
- ä½äº "Album Management" æŒ‰é’®æ—è¾¹
- ç‚¹å‡»è·³è½¬åˆ°æ ‡ç­¾ç®¡ç†é¡µé¢

## æŠ€æœ¯ç»†èŠ‚

### ä½¿ç”¨çš„ç»„ä»¶

1. **Ant Design ç»„ä»¶**:
   - `Table`: æ ‡ç­¾åˆ—è¡¨å±•ç¤º
   - `Modal`: åˆ›å»º/ç¼–è¾‘æ ‡ç­¾å¯¹è¯æ¡†
   - `Form`: æ ‡ç­¾è¡¨å•
   - `ColorPicker`: é¢œè‰²é€‰æ‹©å™¨ï¼ˆAnt Design 5.xï¼‰
   - `Popconfirm`: åˆ é™¤ç¡®è®¤å¯¹è¯æ¡†
   - `Tag`: æ ‡ç­¾å±•ç¤º

2. **è‡ªå®šä¹‰ç»„ä»¶**:
   - `TrackTagsManager`: å•æ›²æ ‡ç­¾ç®¡ç†å¯¹è¯æ¡†ï¼ˆå·²å­˜åœ¨ï¼‰

### API æœåŠ¡

ä½¿ç”¨ `tagService.ts` ä¸­çš„API:
- `getTags()`: è·å–æ‰€æœ‰æ ‡ç­¾
- `createTag(data)`: åˆ›å»ºæ–°æ ‡ç­¾
- `updateTag(id, data)`: æ›´æ–°æ ‡ç­¾
- `deleteTag(id)`: åˆ é™¤æ ‡ç­¾
- `getTrackTags(trackId)`: è·å–å•æ›²çš„æ ‡ç­¾
- `addTagToTrack(trackId, tagId)`: ä¸ºå•æ›²æ·»åŠ æ ‡ç­¾
- `removeTagFromTrack(trackId, tagId)`: ä»å•æ›²ç§»é™¤æ ‡ç­¾

## å®Œæ•´çš„TAGåŠŸèƒ½æµç¨‹

### ç®¡ç†å‘˜è§†è§’

1. **åˆ›å»ºæ ‡ç­¾**:
   ```
   Adminé¡µé¢ â†’ Tag ManagementæŒ‰é’® â†’ æ ‡ç­¾ç®¡ç†é¡µé¢ â†’ åˆ›å»ºæ ‡ç­¾æŒ‰é’®
   â†’ å¡«å†™æ ‡ç­¾ä¿¡æ¯ï¼ˆåç§°ã€é¢œè‰²ã€æè¿°ï¼‰â†’ ä¿å­˜
   ```

2. **ä¸ºå•æ›²æ·»åŠ æ ‡ç­¾**:
   ```
   Adminé¡µé¢ â†’ æ‰¾åˆ°æ­Œæ›² â†’ TagsæŒ‰é’® â†’ é€‰æ‹©æ ‡ç­¾ â†’ è‡ªåŠ¨æ·»åŠ 
   ```

3. **ç¼–è¾‘æ ‡ç­¾**:
   ```
   æ ‡ç­¾ç®¡ç†é¡µé¢ â†’ ç¼–è¾‘æŒ‰é’® â†’ ä¿®æ”¹ä¿¡æ¯ â†’ ä¿å­˜
   ```

4. **åˆ é™¤æ ‡ç­¾**:
   ```
   æ ‡ç­¾ç®¡ç†é¡µé¢ â†’ åˆ é™¤æŒ‰é’® â†’ ç¡®è®¤ â†’ åˆ é™¤ï¼ˆè§£é™¤æ‰€æœ‰å…³è”ï¼‰
   ```

### ç”¨æˆ·è§†è§’ï¼ˆå·²æœ‰åŠŸèƒ½ï¼‰

1. **æŒ‰æ ‡ç­¾æµè§ˆ**:
   ```
   é¦–é¡µ â†’ æ ‡ç­¾æµè§ˆ â†’ é€‰æ‹©æ ‡ç­¾ â†’ æŸ¥çœ‹è¯¥æ ‡ç­¾ä¸‹çš„æ‰€æœ‰æ­Œæ›²
   ```

2. **æŸ¥çœ‹å•æ›²æ ‡ç­¾**:
   ```
   å•æ›²è¯¦æƒ…é¡µ â†’ æ˜¾ç¤ºè¯¥æ›²ç›®çš„æ‰€æœ‰æ ‡ç­¾
   ```

## ç•Œé¢æˆªå›¾æè¿°

### Adminé¡µé¢ - TagsæŒ‰é’®
- åœ¨æ¯é¦–æ­Œæ›²çš„æ“ä½œæ ä¸­ï¼Œæœ‰ä»¥ä¸‹æŒ‰é’®ï¼š
  - **Play**: æ’­æ”¾
  - **Edit**: ç¼–è¾‘åŸºæœ¬ä¿¡æ¯
  - **Lyrics**: ç¼–è¾‘æ­Œè¯
  - **Credits**: ç¼–è¾‘åˆ¶ä½œäººå‘˜
  - **Tags**: ç®¡ç†æ ‡ç­¾ â­ **æ–°å¢**
  - **Download**: ä¸‹è½½
  - **Delete**: åˆ é™¤

### æ ‡ç­¾ç®¡ç†é¡µé¢
- é¡µé¢æ ‡é¢˜: "ğŸ·ï¸ æ ‡ç­¾ç®¡ç†"
- å³ä¸Šè§’: "åˆ›å»ºæ ‡ç­¾" æŒ‰é’®
- è¡¨æ ¼å±•ç¤ºæ‰€æœ‰æ ‡ç­¾
- æ¯è¡Œæ“ä½œ: "ç¼–è¾‘" | "åˆ é™¤"

### å•æ›²æ ‡ç­¾ç®¡ç†å¯¹è¯æ¡†
- æ ‡é¢˜: "ç®¡ç†æ ‡ç­¾ - [æ­Œæ›²å]"
- å½“å‰æ ‡ç­¾: ä»¥å½©è‰²æ ‡ç­¾å½¢å¼å±•ç¤ºï¼Œç‚¹å‡» X å¯åˆ é™¤
- æ·»åŠ æ ‡ç­¾: ä¸‹æ‹‰é€‰æ‹©æ¡†ï¼Œé€‰æ‹©åè‡ªåŠ¨æ·»åŠ 
- æç¤ºä¿¡æ¯: "ğŸ’¡ æç¤ºï¼šæ‚¨å¯ä»¥åœ¨'æ ‡ç­¾ç®¡ç†'é¡µé¢åˆ›å»ºæ–°æ ‡ç­¾"

## æ•°æ®åº“è®¾è®¡ï¼ˆå·²æœ‰ï¼‰

### tags è¡¨
```sql
- id: ä¸»é”®
- name: æ ‡ç­¾åç§°ï¼ˆå”¯ä¸€ï¼‰
- color: æ ‡ç­¾é¢œè‰²
- description: æ ‡ç­¾æè¿°
- created_at: åˆ›å»ºæ—¶é—´
- updated_at: æ›´æ–°æ—¶é—´
```

### track_tags è¡¨ï¼ˆå…³è”è¡¨ï¼‰
```sql
- id: ä¸»é”®
- track_id: æ­Œæ›²IDï¼ˆå¤–é”®ï¼‰
- tag_id: æ ‡ç­¾IDï¼ˆå¤–é”®ï¼‰
- created_at: å…³è”åˆ›å»ºæ—¶é—´
```

## æµ‹è¯•å»ºè®®

### åŠŸèƒ½æµ‹è¯•

1. **æ ‡ç­¾ç®¡ç†é¡µé¢æµ‹è¯•**:
   - [ ] åˆ›å»ºæ ‡ç­¾ï¼ˆå¡«å†™æ‰€æœ‰å­—æ®µï¼‰
   - [ ] åˆ›å»ºæ ‡ç­¾ï¼ˆä»…å¡«å†™å¿…å¡«å­—æ®µï¼‰
   - [ ] ç¼–è¾‘æ ‡ç­¾
   - [ ] åˆ é™¤æ ‡ç­¾
   - [ ] åˆ é™¤æœ‰å…³è”æ­Œæ›²çš„æ ‡ç­¾

2. **å•æ›²æ ‡ç­¾ç®¡ç†æµ‹è¯•**:
   - [ ] ä¸ºå•æ›²æ·»åŠ æ ‡ç­¾
   - [ ] ä¸ºå•æ›²æ·»åŠ å¤šä¸ªæ ‡ç­¾
   - [ ] ä»å•æ›²ç§»é™¤æ ‡ç­¾
   - [ ] æ·»åŠ å·²å­˜åœ¨çš„æ ‡ç­¾ï¼ˆåº”æç¤ºé‡å¤ï¼‰

3. **ç•Œé¢æµ‹è¯•**:
   - [ ] æ ‡ç­¾é¢œè‰²æ­£ç¡®æ˜¾ç¤º
   - [ ] æ­Œæ›²æ•°é‡ç»Ÿè®¡æ­£ç¡®
   - [ ] åˆ é™¤æ ‡ç­¾çš„ç¡®è®¤å¯¹è¯æ¡†
   - [ ] ç©ºçŠ¶æ€æ˜¾ç¤ºï¼ˆæ²¡æœ‰æ ‡ç­¾æ—¶ï¼‰

4. **æƒé™æµ‹è¯•**:
   - [ ] æœªç™»å½•ç”¨æˆ·æ— æ³•è®¿é—® `/admin/tags`
   - [ ] æœªç™»å½•ç”¨æˆ·æ— æ³•åœ¨Adminé¡µé¢æ“ä½œ

### é›†æˆæµ‹è¯•

1. **å®Œæ•´æµç¨‹æµ‹è¯•**:
   - [ ] åˆ›å»ºæ ‡ç­¾ â†’ ä¸ºæ­Œæ›²æ·»åŠ æ ‡ç­¾ â†’ åœ¨å…¬å¼€é¡µé¢æŸ¥çœ‹ â†’ æŒ‰æ ‡ç­¾æµè§ˆ
   - [ ] ç¼–è¾‘æ ‡ç­¾é¢œè‰² â†’ æ£€æŸ¥æ‰€æœ‰ä½¿ç”¨è¯¥æ ‡ç­¾çš„åœ°æ–¹æ˜¯å¦æ›´æ–°
   - [ ] åˆ é™¤æ ‡ç­¾ â†’ æ£€æŸ¥æ­Œæ›²æ ‡ç­¾æ˜¯å¦è¢«ç§»é™¤

## å·²çŸ¥é—®é¢˜å’Œé™åˆ¶

1. **æ ‡ç­¾é¢œè‰²é€‰æ‹©å™¨**: ä½¿ç”¨ Ant Design 5.x çš„ ColorPicker ç»„ä»¶ï¼Œéœ€ç¡®ä¿ antd ç‰ˆæœ¬ >= 5.0
2. **æ ‡ç­¾åˆ é™¤**: åˆ é™¤æ ‡ç­¾ä¼šè§£é™¤æ‰€æœ‰æ­Œæ›²çš„å…³è”ï¼Œä½†ä¸ä¼šåˆ é™¤æ­Œæ›²æœ¬èº«
3. **æ ‡ç­¾åç§°å”¯ä¸€æ€§**: åç«¯åº”ç¡®ä¿æ ‡ç­¾åç§°çš„å”¯ä¸€æ€§çº¦æŸ

## æœªæ¥æ”¹è¿›å»ºè®®

1. **æ‰¹é‡æ“ä½œ**: æ”¯æŒä¸ºå¤šé¦–æ­Œæ›²æ‰¹é‡æ·»åŠ æ ‡ç­¾
2. **æ ‡ç­¾ç»Ÿè®¡**: æ·»åŠ æ ‡ç­¾ä½¿ç”¨é¢‘ç‡ç»Ÿè®¡å›¾è¡¨
3. **æ ‡ç­¾æœç´¢**: åœ¨æ ‡ç­¾ç®¡ç†é¡µé¢æ·»åŠ æœç´¢åŠŸèƒ½
4. **æ ‡ç­¾åˆ†ç±»**: æ”¯æŒæ ‡ç­¾çš„å±‚çº§åˆ†ç±»ï¼ˆå¦‚ï¼šæ¸¸æˆ > åŸç¥ > è§’è‰²æ›²ï¼‰
5. **æ ‡ç­¾å»ºè®®**: åŸºäºæ­Œæ›²å…ƒæ•°æ®è‡ªåŠ¨æ¨èæ ‡ç­¾
6. **æ‹–æ‹½æ’åº**: æ”¯æŒæ‹–æ‹½æ ‡ç­¾æ”¹å˜æ˜¾ç¤ºé¡ºåº

## æ–‡ä»¶æ¸…å•

### æ–°å¢æ–‡ä»¶
- `frontend/src/pages/TagManagement.tsx` - æ ‡ç­¾ç®¡ç†é¡µé¢
- `frontend/src/pages/TagManagement.css` - æ ‡ç­¾ç®¡ç†é¡µé¢æ ·å¼

### ä¿®æ”¹æ–‡ä»¶
- `frontend/src/pages/Admin.tsx` - æ·»åŠ TagsæŒ‰é’®å’Œå¯¼èˆª
- `frontend/src/App.tsx` - æ·»åŠ è·¯ç”±é…ç½®

### å·²å­˜åœ¨ï¼ˆæœªä¿®æ”¹ï¼‰
- `frontend/src/components/TrackTagsManager.tsx` - å•æ›²æ ‡ç­¾ç®¡ç†ç»„ä»¶
- `frontend/src/services/tagService.ts` - æ ‡ç­¾APIæœåŠ¡
- `frontend/src/pages/Tags.tsx` - å…¬å¼€æ ‡ç­¾æµè§ˆé¡µé¢
- `frontend/src/pages/TagDetail.tsx` - æ ‡ç­¾è¯¦æƒ…é¡µé¢

## æ€»ç»“

æœ¬æ¬¡æ›´æ–°å®Œæ•´å®ç°äº†PRDä¸­çš„æ ‡ç­¾ç³»ç»Ÿéœ€æ±‚ï¼Œä½¿ç®¡ç†å‘˜èƒ½å¤Ÿæ–¹ä¾¿åœ°åˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤æ ‡ç­¾ï¼Œå¹¶ä¸ºå•æ›²åˆ†é…æ ‡ç­¾ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡æ ‡ç­¾å¿«é€Ÿæ‰¾åˆ°ç›¸å…³éŸ³ä¹ï¼Œæå‡äº†å†…å®¹ç»„ç»‡å’Œæ£€ç´¢çš„ä¾¿åˆ©æ€§ã€‚

æ‰€æœ‰åŠŸèƒ½å‡å·²å®ç°å¹¶é€šè¿‡ç¼–è¯‘ï¼Œå¯ä»¥ç«‹å³æŠ•å…¥ä½¿ç”¨ã€‚

